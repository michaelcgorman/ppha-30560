<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <style>
        .chart-container {
            max-width: 1050px;
            /*border: 3px solid red;*/
            margin: 0 auto;
            /* auto centers the div */
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }

        svg {
            /*border: 2px solid purple;*/
            overflow: visible;
        }


        svg + h1 {
            margin-top: 4em;
        }

        
    </style>
</head>

<body>
    <div class="chart-container">
        <h1 class="headline">
            Unemployment Chart Headline
        </h1>

        <svg width="945px" height="756px" id="unemployment_chart">

        </svg>

        <h1 class="headline">
            New Delhi Chart Headline
        </h1>
        <svg width="525px" height="500px" id="new_delhi_chart">

        </svg>
        <h1 class="headline">
            Farming Chart Headline
        </h1>

        <svg width="763px" height="573px" id="farming_chart">

        </svg>

        <h1 class="headline">
            College Chart Headline
        </h1>
        <svg width="1050px" height="400px" id="college_chart">

        </svg>
    </div>
</body>

<!-- add your script blocks at the end -->
<script src="https://d3js.org/d3.v6.min.js"></script>
<!-- we're using d3 version 6 (the latest version) for all our work -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.5.1/d3-annotation.min.js"></script>

<script>
    console.log(d3)
    
    // start unemployment chart code
    // based on first graph from: https://www.nytimes.com/interactive/2020/03/26/upshot/coronavirus-millions-unemployment-claims.html

    d3.csv("nat.csv").then(function (unemployment_data) {
        let svg = d3.select("#unemployment_chart")
        let width = 945;
        let height = 756;
        console.log("Unemployment data loaded:")
        console.log(unemployment_data)

        
    })

    // end unemployment chart code







    // start new delhi chart code
    // based on second graph from the bottom of: https://www.nytimes.com/interactive/2019/12/02/climate/air-pollution-compare-ar-ul.html

    d3.csv("India-NCT-Delhi-daily.csv").then(function (new_delhi_data) {
        let svg = d3.select("#new_delhi_chart")
        let width = 525;
        let height = 500;
        console.log("New Delhi data loaded:")
        console.log(new_delhi_data)

        
    })

    // end new delhi chart code







    // start farming chart code
    // based on first graph from: https://www.npr.org/sections/money/2015/05/18/404991483/how-machines-destroy-and-create-jobs-in-4-graphs

    d3.csv("firstjob_major_d3_3.csv").then(function (farming_data) {
        let svg = d3.select("#farming_chart")
        let width = 763;
        let height = 573;
        console.log("Farming data loaded:")
        console.log(farming_data)

        let margin = { top: 10, right: 10, bottom: 10, left: 30 };

        let sel_cols = [
            "Other",
            "White Collar",
            "Service",
            "Blue Collar",
            "Farming"]

        let sel_colors = [
            "#cccccc",  // "Other"
            "#dd488f", // "White Collar"
            "#dfd060", // "Service"
            "#178fe8", // "Blue Collar"
            "#29a97e", // "Farming"
        ]

        farming_data.forEach(function(row) {
            sel_cols.forEach(function (col) {
                row[col] = +row[col]
            })

            row.year = +row.year
        })

        let farming_series = d3.stack().keys(sel_cols)(farming_data)
        console.log({farming_series})

        let color = d3.scaleOrdinal()
            .domain(sel_cols)
            .range(sel_colors)

        let x = d3.scaleLinear()
            .domain(d3.extent(farming_data.map(function (d) { return d.year })))
            .range([margin.left, width])

        let y = d3.scaleLinear()
            .domain(d3.extent(
                function (data, column_names) {
                    var result = []
                    data.forEach(function (row) {
                        var date_sum = 0
                        column_names.forEach(function (name) {
                            result[result.length] = row[name]
                            date_sum = date_sum + row[name]
                        })
                        result[result.length] = date_sum
                    })
                    return(result)
                }(farming_data, sel_cols)
            ))
            .range([height - margin.bottom, margin.top])

        let area = d3.area()
            .x(d => x(d.data.year))
            .y0(d => y(d[0]))
            .y1(d => y(d[1]))

        let xAxisSettings = d3.axisBottom(x)
            .tickSize(6)
            .tickPadding(6)
            .tickValues([1850, 1860, 1870, 1880, 1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010])
            .tickFormat(d3.format(".0f"))

        let xAxis = svg.append("g")
            .attr("class", "x axis")
            .call(xAxisSettings)
            .call(g => g.selectAll(".domain").remove())
            .attr("transform", `translate(0,${height - margin.bottom})`)


        let yAxisSettings = d3.axisLeft(y)
            .ticks(10)
            .tickSize(6)
            .tickPadding(4)
            .tickFormat(d3.format(",.0f"))

        let yAxis = svg
            .append("g")
            .attr("class", "y axis")
            .call(yAxisSettings)
            .call(g => g.selectAll(".domain").remove())
        
        svg.append("g")
            .selectAll("path")
            .data(farming_series)
            .join("path")
            .attr("class", d => {
                console.log(d)
                return d.key
            })
            .attr("d", area)
            .attr("fill", d => color(d.key))
            .attr("fill-opacity", 0.8)

        let labels = svg.append("g")
            .attr("class", "category-labels")

        labels.append("text")
            .attr("class", "label")
            .attr("x", x(1982))
            .attr("y", y(1000000))
            .text("Other")

        labels.append("text")
            .attr("class", "label")
            .attr("x", x(1982))
            .attr("y", y(20000000))
            .text("White Collar")

        labels.append("text")
            .attr("class", "label")
            .attr("x", x(1982))
            .attr("y", y(70000000))
            .text("Services")

        labels.append("text")
            .attr("class", "label")
            .attr("x", x(1982))
            .attr("y", y(93000000))
            .text("Blue Collar")

        labels.append("text")
            .attr("class", "label")
            .attr("x", x(1890))
            .attr("y", y(20000000))
            .text("Farming")
    })

    // end farming chart code







    // start college chart code
    // based on second graph from: https://www.nytimes.com/interactive/2017/01/18/upshot/some-colleges-have-more-students-from-the-top-1-percent-than-the-bottom-60.html

    d3.csv("college-selection-by-income-group-01-13.csv").then(function (college_data) {
        let svg = d3.select("#college_chart")
        let width = 1050;
        let height = 400;
        console.log("College data loaded:")
        console.log(college_data)

        
    })

    // end college chart code

</script>